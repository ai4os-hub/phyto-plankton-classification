2025-04-23 14:08:14,386 - SimulatorRunner - INFO - Create the Simulator Server.
2025-04-23 14:08:14,387 - CoreCell - INFO - server: creating listener on tcp://0:52760
2025-04-23 14:08:14,401 - CoreCell - INFO - server: created backbone external listener for tcp://0:52760
2025-04-23 14:08:14,401 - ConnectorManager - INFO - 19306: Try start_listener Listener resources: {'secure': False, 'host': 'localhost'}
2025-04-23 14:08:14,402 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connector [CH00002 PASSIVE tcp://0:56171] is starting
2025-04-23 14:08:14,903 - CoreCell - INFO - server: created backbone internal listener for tcp://localhost:56171
2025-04-23 14:08:14,904 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connector [CH00001 PASSIVE tcp://0:52760] is starting
2025-04-23 14:08:14,906 - SimulatorServer - INFO - max_reg_duration=60.0
2025-04-23 14:08:14,971 - nvflare.fuel.hci.server.hci - INFO - Starting Admin Server localhost on Port 52761
2025-04-23 14:08:14,971 - SimulatorRunner - INFO - Deploy the Apps.
2025-04-23 14:08:14,984 - SimulatorRunner - INFO - Create the simulate clients.
2025-04-23 14:08:14,986 - Communicator - INFO - Trying to register with server ...
2025-04-23 14:08:14,986 - ClientManager - INFO - authenticated client site-1
2025-04-23 14:08:14,986 - ClientManager - INFO - Client: New client site-1@172.17.11.69 joined. Sent token: ab3d9046-9bdf-4c15-827b-a4632bb4e7de.  Total clients: 1
2025-04-23 14:08:14,986 - Communicator - INFO - register RC: ok
2025-04-23 14:08:14,986 - FederatedClient - INFO - Successfully registered client:site-1 for project simulator_server. Token:ab3d9046-9bdf-4c15-827b-a4632bb4e7de SSID:
2025-04-23 14:08:14,987 - Communicator - INFO - Trying to register with server ...
2025-04-23 14:08:14,987 - ClientManager - INFO - authenticated client site-2
2025-04-23 14:08:14,987 - ClientManager - INFO - Client: New client site-2@172.17.11.69 joined. Sent token: 82763c30-36b1-4833-8efd-e50bbf621a12.  Total clients: 2
2025-04-23 14:08:14,987 - Communicator - INFO - register RC: ok
2025-04-23 14:08:14,987 - FederatedClient - INFO - Successfully registered client:site-2 for project simulator_server. Token:82763c30-36b1-4833-8efd-e50bbf621a12 SSID:
2025-04-23 14:08:14,987 - SimulatorRunner - INFO - Set the client status ready.
2025-04-23 14:08:14,987 - SimulatorRunner - INFO - Deploy and start the Server App.
2025-04-23 14:08:14,988 - Cell - INFO - Register blob CB for channel='server_command', topic='*'
2025-04-23 14:08:14,988 - Cell - INFO - Register blob CB for channel='aux_communication', topic='*'
2025-04-23 14:08:14,988 - ServerCommandAgent - INFO - ServerCommandAgent cell register_request_cb: server.simulate_job
2025-04-23 14:08:19,709 - AuxRunner - INFO - registered aux handler for topic __sync_runner__
2025-04-23 14:08:19,709 - AuxRunner - INFO - registered aux handler for topic __job_heartbeat__
2025-04-23 14:08:19,709 - AuxRunner - INFO - registered aux handler for topic __task_check__
2025-04-23 14:08:19,709 - AuxRunner - INFO - registered aux handler for topic RM.RELIABLE_REQUEST
2025-04-23 14:08:19,710 - AuxRunner - INFO - registered aux handler for topic RM.RELIABLE_REPLY
2025-04-23 14:08:19,710 - ReliableMessage - INFO - enabled reliable message: max_request_workers=20 query_interval=2.0
2025-04-23 14:08:19,711 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job]: Server runner starting ...
2025-04-23 14:08:20,009 - SimulatorClientRunner - INFO - Start the clients run simulation.
2025-04-23 14:08:21,013 - SimulatorClientRunner - INFO - Simulate Run client: site-1 on GPU group: None
2025-04-23 14:08:22,112 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00005 127.0.0.1:52760 <= 127.0.0.1:52769] is created: PID: 19306
2025-04-23 14:08:22,735 - MLflowReceiver - INFO - Experiment=<Experiment: artifact_location='file:///hkfs/home/project/hk-project-test-p0023500/mp9809/NVFlare/examples/getting_started/tf/cifar10_tf_fedopt_trial_0/server/simulate_job/artifacts', creation_time=1743516005988, experiment_id='132', last_update_time=1743516005988, lifecycle_stage='active', name='Optuna', tags={}>
2025-04-23 14:08:23,807 - SimulatorClientRunner - INFO - Simulate Run client: site-2 on GPU group: None
2025-04-23 14:08:23,807 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00005 Not Connected] is closed PID: 19306
2025-04-23 14:08:24,654 - MLflowReceiver - INFO - Experiment=<Experiment: artifact_location='file:///hkfs/home/project/hk-project-test-p0023500/mp9809/NVFlare/examples/getting_started/tf/cifar10_tf_fedopt_trial_0/server/simulate_job/artifacts', creation_time=1743516005988, experiment_id='132', last_update_time=1743516005988, lifecycle_stage='active', name='Optuna', tags={}>
2025-04-23 14:08:25,649 - AuxRunner - INFO - registered aux handler for topic fed.event
2025-04-23 14:08:25,650 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job]: starting workflow scatter_and_gather (<class 'nvflare.app_common.workflows.fedavg.FedAvg'>) ...
2025-04-23 14:08:25,651 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Initializing BaseModelController workflow.
2025-04-23 14:08:25,651 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Workflow scatter_and_gather (<class 'nvflare.app_common.workflows.fedavg.FedAvg'>) started
2025-04-23 14:08:25,651 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Beginning model controller run.
2025-04-23 14:08:25,652 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Start FedAvg.
2025-04-23 14:08:25,652 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: loading initial model from persistor
2025-04-23 14:08:25,706 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Round 0 started.
2025-04-23 14:08:25,706 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Sampled clients: ['site-1', 'site-2']
2025-04-23 14:08:25,707 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Sending task train to ['site-1', 'site-2']
2025-04-23 14:08:25,707 - WFCommServer - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: scheduled task train
2025-04-23 14:08:25,863 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00006 127.0.0.1:52760 <= 127.0.0.1:52775] is created: PID: 19306
2025-04-23 14:08:26,550 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-2, peer_run=simulate_job, task_name=train, task_id=3c092ad5-f86a-4714-a534-a7211b7d5b18]: assigned task to client site-2: name=train, id=3c092ad5-f86a-4714-a534-a7211b7d5b18
2025-04-23 14:08:26,550 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-2, peer_run=simulate_job, task_name=train, task_id=3c092ad5-f86a-4714-a534-a7211b7d5b18]: sent task assignment to client. client_name:site-2 task_id:3c092ad5-f86a-4714-a534-a7211b7d5b18
2025-04-23 14:08:26,550 - GetTaskCommand - INFO - return task to client.  client_name: site-2  task_name: train   task_id: 3c092ad5-f86a-4714-a534-a7211b7d5b18  sharable_header_task_id: 3c092ad5-f86a-4714-a534-a7211b7d5b18
2025-04-23 14:08:49,927 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-2, peer_run=simulate_job]: got result from client site-2 for task: name=train, id=3c092ad5-f86a-4714-a534-a7211b7d5b18
2025-04-23 14:08:50,067 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-2, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=3c092ad5-f86a-4714-a534-a7211b7d5b18]: finished processing client result by scatter_and_gather
2025-04-23 14:08:50,067 - SubmitUpdateCommand - INFO - submit_update process. client_name:site-2   task_id:3c092ad5-f86a-4714-a534-a7211b7d5b18
2025-04-23 14:08:50,071 - SimulatorClientRunner - INFO - Simulate Run client: site-1 on GPU group: None
2025-04-23 14:08:50,072 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00006 Not Connected] is closed PID: 19306
2025-04-23 14:08:52,183 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00007 127.0.0.1:52760 <= 127.0.0.1:52795] is created: PID: 19306
2025-04-23 14:08:52,887 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: assigned task to client site-1: name=train, id=bfe1175d-0ec5-4d81-992d-e1b8b963567d
2025-04-23 14:08:52,887 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: sent task assignment to client. client_name:site-1 task_id:bfe1175d-0ec5-4d81-992d-e1b8b963567d
2025-04-23 14:08:52,887 - GetTaskCommand - INFO - return task to client.  client_name: site-1  task_name: train   task_id: bfe1175d-0ec5-4d81-992d-e1b8b963567d  sharable_header_task_id: bfe1175d-0ec5-4d81-992d-e1b8b963567d
2025-04-23 14:09:16,131 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job]: got result from client site-1 for task: name=train, id=bfe1175d-0ec5-4d81-992d-e1b8b963567d
2025-04-23 14:09:16,265 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: finished processing client result by scatter_and_gather
2025-04-23 14:09:16,265 - SubmitUpdateCommand - INFO - submit_update process. client_name:site-1   task_id:bfe1175d-0ec5-4d81-992d-e1b8b963567d
2025-04-23 14:09:16,270 - SimulatorClientRunner - INFO - Simulate Run client: site-2 on GPU group: None
2025-04-23 14:09:16,271 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00007 Not Connected] is closed PID: 19306
2025-04-23 14:09:16,331 - WFCommServer - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: task train exit with status TaskCompletionStatus.OK
2025-04-23 14:09:16,527 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: aggregating 2 update(s) at round 0
2025-04-23 14:09:16,618 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: Start persist model on server.
2025-04-23 14:09:16,796 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: End persist model on server.
2025-04-23 14:09:16,796 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: Round 1 started.
2025-04-23 14:09:16,796 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: Sampled clients: ['site-1', 'site-2']
2025-04-23 14:09:16,797 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: Sending task train to ['site-1', 'site-2']
2025-04-23 14:09:16,797 - WFCommServer - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=bfe1175d-0ec5-4d81-992d-e1b8b963567d]: scheduled task train
2025-04-23 14:09:18,371 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00008 127.0.0.1:52760 <= 127.0.0.1:52817] is created: PID: 19306
2025-04-23 14:09:19,070 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-2, peer_run=simulate_job, task_name=train, task_id=a1395f01-06c2-44bd-8c61-406968f3a326]: assigned task to client site-2: name=train, id=a1395f01-06c2-44bd-8c61-406968f3a326
2025-04-23 14:09:19,070 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-2, peer_run=simulate_job, task_name=train, task_id=a1395f01-06c2-44bd-8c61-406968f3a326]: sent task assignment to client. client_name:site-2 task_id:a1395f01-06c2-44bd-8c61-406968f3a326
2025-04-23 14:09:19,070 - GetTaskCommand - INFO - return task to client.  client_name: site-2  task_name: train   task_id: a1395f01-06c2-44bd-8c61-406968f3a326  sharable_header_task_id: a1395f01-06c2-44bd-8c61-406968f3a326
2025-04-23 14:09:42,317 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-2, peer_run=simulate_job]: got result from client site-2 for task: name=train, id=a1395f01-06c2-44bd-8c61-406968f3a326
2025-04-23 14:09:42,462 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-2, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=a1395f01-06c2-44bd-8c61-406968f3a326]: finished processing client result by scatter_and_gather
2025-04-23 14:09:42,462 - SubmitUpdateCommand - INFO - submit_update process. client_name:site-2   task_id:a1395f01-06c2-44bd-8c61-406968f3a326
2025-04-23 14:09:42,466 - SimulatorClientRunner - INFO - Simulate Run client: site-1 on GPU group: None
2025-04-23 14:09:42,467 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00008 Not Connected] is closed PID: 19306
2025-04-23 14:09:44,548 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00009 127.0.0.1:52760 <= 127.0.0.1:52844] is created: PID: 19306
2025-04-23 14:09:45,244 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, task_name=train, task_id=fc0ea03c-ab52-4e81-949a-aa61431af87f]: assigned task to client site-1: name=train, id=fc0ea03c-ab52-4e81-949a-aa61431af87f
2025-04-23 14:09:45,244 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, task_name=train, task_id=fc0ea03c-ab52-4e81-949a-aa61431af87f]: sent task assignment to client. client_name:site-1 task_id:fc0ea03c-ab52-4e81-949a-aa61431af87f
2025-04-23 14:09:45,244 - GetTaskCommand - INFO - return task to client.  client_name: site-1  task_name: train   task_id: fc0ea03c-ab52-4e81-949a-aa61431af87f  sharable_header_task_id: fc0ea03c-ab52-4e81-949a-aa61431af87f
2025-04-23 14:10:08,453 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job]: got result from client site-1 for task: name=train, id=fc0ea03c-ab52-4e81-949a-aa61431af87f
2025-04-23 14:10:08,618 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=fc0ea03c-ab52-4e81-949a-aa61431af87f]: finished processing client result by scatter_and_gather
2025-04-23 14:10:08,618 - WFCommServer - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: task train exit with status TaskCompletionStatus.OK
2025-04-23 14:10:08,626 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=fc0ea03c-ab52-4e81-949a-aa61431af87f]: aggregating 2 update(s) at round 1
2025-04-23 14:10:08,626 - SubmitUpdateCommand - INFO - submit_update process. client_name:site-1   task_id:fc0ea03c-ab52-4e81-949a-aa61431af87f
2025-04-23 14:10:08,632 - SimulatorClientRunner - INFO - Simulate Run client: site-2 on GPU group: None
2025-04-23 14:10:08,634 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00009 Not Connected] is closed PID: 19306
2025-04-23 14:10:08,733 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=fc0ea03c-ab52-4e81-949a-aa61431af87f]: Start persist model on server.
2025-04-23 14:10:08,934 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=fc0ea03c-ab52-4e81-949a-aa61431af87f]: End persist model on server.
2025-04-23 14:10:08,934 - FedAvg - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-1, peer_run=simulate_job, peer_rc=OK, task_name=train, task_id=fc0ea03c-ab52-4e81-949a-aa61431af87f]: Finished FedAvg.
2025-04-23 14:10:08,937 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Workflow: scatter_and_gather finalizing ...
2025-04-23 14:10:08,948 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: ABOUT_TO_END_RUN fired
2025-04-23 14:10:08,949 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Firing CHECK_END_RUN_READINESS ...
2025-04-23 14:10:10,748 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00010 127.0.0.1:52760 <= 127.0.0.1:52866] is created: PID: 19306
2025-04-23 14:10:14,713 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: END_RUN fired
2025-04-23 14:10:14,714 - ReliableMessage - INFO - ReliableMessage is shutdown
2025-04-23 14:10:14,715 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: Server runner finished.
2025-04-23 14:10:14,734 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather, peer=site-2, peer_run=simulate_job]: server runner is finalizing - asked client to end the run
2025-04-23 14:10:14,734 - GetTaskCommand - INFO - return task to client.  client_name: site-2  task_name: __end_run__   task_id:   sharable_header_task_id: 
2025-04-23 14:10:14,946 - SimulatorClientRunner - INFO - Simulate Run client: site-1 on GPU group: None
2025-04-23 14:10:14,947 - FederatedClient - INFO - Shutting down client run: site-1
2025-04-23 14:10:14,947 - FederatedClient - INFO - Shutting down client run: site-2
2025-04-23 14:10:14,948 - ServerRunner - INFO - [identity=simulator_server, run=simulate_job, wf=scatter_and_gather]: asked to abort - triggered abort_signal to stop the RUN
2025-04-23 14:10:14,948 - nvflare.fuel.f3.sfm.conn_manager - INFO - Connection [CN00010 Not Connected] is closed PID: 19306
2025-04-23 14:10:15,895 - ReliableMessage - INFO - shutdown reliable message monitor
2025-04-23 14:10:16,858 - SimulatorServer - INFO - Server app stopped.


2025-04-23 14:10:17,143 - nvflare.fuel.hci.server.hci - INFO - Admin Server localhost on Port 52761 shutdown!
2025-04-23 14:10:17,145 - SimulatorServer - INFO - shutting down server
2025-04-23 14:10:17,145 - SimulatorServer - INFO - canceling sync locks
2025-04-23 14:10:17,145 - SimulatorServer - INFO - server off
2025-04-23 14:10:20,644 - MPM - WARNING - #### MPM: still running thread Thread-9
2025-04-23 14:10:20,645 - MPM - INFO - MPM: Good Bye!
