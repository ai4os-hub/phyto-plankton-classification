# PI10 TAR Processing Pipeline
 
This script `VLIZ-Pi-10_processing.py` is a comprehensive pipeline designed to process `.tar` files generated by the Plankton Imager 10 (PI10) system. It automates the extraction, classification, metadata analysis, and reporting of plankton image data.
 
## Purpose
 
The pipeline continuously monitors a source directory for new `.tar` files and performs the following tasks:
- Untars and extracts image data
- Generates preview images
- Classifies images using a trained deep learning model
- Extracts EXIF metadata including GPS and timestamps
- Computes morphological features of detected plankton
- Generates top species predictions
- Logs per-minute biological metrics
- Sends daily summary emails
- Logs processing times for each step
 
## Usage
 
1. **Environment Setup**:
   - Ensure required Python packages are installed (TensorFlow, scikit-image, pandas, etc.).
   - Configure `.env` file with email settings for notifications.
 
2. **Directory Configuration**:
   - Update paths in the script to match your local setup:
     - `source_dir`: Directory containing `.tar` files
     - `work_dir`: Temporary working directory
     - `quarantine_*_dir`: Quarantine directories for problematic files
 
3. **Model Configuration**:
   - Place the trained model (`final_model.h5`) and configuration files in the expected directories.
   - Set the `TIMESTAMP` and `MODEL_NAME` variables accordingly.
 
4. **Execution**:
   - Run the script to start the continuous monitoring and processing loop.
   - The script will automatically process new `.tar` files and log results.
 
## Structure
 
- **Setup**: Initializes directories, loads model and configuration
- **Email Scheduler**: Sends daily summary emails at a fixed time
- **Logging**: Tracks processing time for each step and writes to CSV
- **Main Pipeline**:
  - `process_tar(tar_file)`: Main function to process each `.tar` file
  - Includes steps for untarring, preview generation, classification, metadata extraction, and reporting
- **Helper Functions**: Modular functions for each processing step
- **Continuous Watch**: Monitors for new `.tar` files and triggers processing
 
## Output
 
- Processed files with predictions and metrics saved in the source directory
- Daily summary emails with processing statistics
- CSV logs of processing times and biological metrics
 
## Notes
 
- Files with insufficient data or high bubble content are quarantined
- The pipeline is designed to be robust and modular for easy maintenance
 
## Author
 
Jonas Mortelmans
 
---
 
For questions or contributions, please contact the repository maintainer.